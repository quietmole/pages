<!DOCTYPE HTML>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Bookmarklet of quietmole</title>
</head>
<body>
<h1>Bookmarklet of quietmole</h1>

Bookmarklet for Safari and Chrome.


<h3>Create link plain</h3>

Create plain link from selected text or current page title.<br />
<em>E.g. Bookmarklet of quietmole https://quietmole.github.io/pages/</em><br />

<a href="javascript:(function(){var%20selected=('getSelection'in%20window%3Fwindow:document).getSelection().toString();var%20title=window.document.title;var%20url=window.location.href;var%20result=[];if(selected){result.push(selected)}else%20if(title){result.push(title)}result.push(url);window.prompt('created%20link',result.join('%20'))}())">create link plain</a> / <a href="javascript:(function(){window.prompt('built%20javascript','javascript:(function(){var%2520selected=(\'getSelection\'in%2520window%253Fwindow:document).getSelection().toString();var%2520title=window.document.title;var%2520url=window.location.href;var%2520result=[];if(selected){result.push(selected)}else%2520if(title){result.push(title)}result.push(url);window.prompt(\'created%2520link\',result.join(\'%2520\'))}())')}())">copy javascript</a>


<h3>Create link markdown</h3>

Create markdown link from selected text or current page title.<br />
<em>E.g. [Bookmarklet of quietmole](https://quietmole.github.io/pages/)</em><br />

<a href="javascript:(function(){var%20selected=('getSelection'in%20window%3Fwindow:document).getSelection().toString();var%20title=window.document.title;var%20url=window.location.href;var%20result=[];if(selected){result.push('['+selected+']')}else{result.push('['+title+']')}result.push('('+url+')');window.prompt('created%20link',result.join(''))}())">create link markdown</a> / <a href="javascript:(function(){window.prompt('built%20javascript','javascript:(function(){var%2520selected=(\'getSelection\'in%2520window%253Fwindow:document).getSelection().toString();var%2520title=window.document.title;var%2520url=window.location.href;var%2520result=[];if(selected){result.push(\'[\'+selected+\']\')}else{result.push(\'[\'+title+\']\')}result.push(\'(\'+url+\')\');window.prompt(\'created%2520link\',result.join(\'\'))}())')}())">copy javascript</a>


<h3>Create link html</h3>

Create html link from selected text or current page title.<br />
<em>E.g. &lt;a href="https://quietmole.github.io/pages/"&gt;Bookmarklet of quietmole&lt;/a&gt;</em><br />

<a href="javascript:(function(){function%20baseToString(a){return%20a==null%3F'':a+''}var%20reUnescapedHtml=/[%26%3C%3E%22'`]/g;var%20reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var%20htmlEscapes={'%26':'%26amp;','%3C':'%26lt;','%3E':'%26gt;','%22':'%26quot;','\'':'%26%2339;','`':'%26%2396;'};function%20escapeHtmlChar(a){return%20htmlEscapes[a]}function%20escape(a){a=baseToString(a);return%20a%26%26reHasUnescapedHtml.test(a)%3Fa.replace(reUnescapedHtml,escapeHtmlChar):a}var%20selected=('getSelection'in%20window%3Fwindow:document).getSelection().toString();var%20title=window.document.title;var%20url=window.location.href;var%20result='';result+='%3Ca%20href=%22'+escape(url)+'%22%3E';if(selected){result+=escape(selected)}else{result+=escape(title)}result+='%3C/a%3E';window.prompt('created%20link',result)}())">create link html</a> / <a href="javascript:(function(){window.prompt('built%20javascript','javascript:(function(){function%2520baseToString(a){return%2520a==null%253F\'\':a+\'\'}var%2520reUnescapedHtml=/[%2526%253C%253E%2522\'`]/g;var%2520reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var%2520htmlEscapes={\'%2526\':\'%2526amp;\',\'%253C\':\'%2526lt;\',\'%253E\':\'%2526gt;\',\'%2522\':\'%2526quot;\',\'\'\':\'%2526%252339;\',\'`\':\'%2526%252396;\'};function%2520escapeHtmlChar(a){return%2520htmlEscapes[a]}function%2520escape(a){a=baseToString(a);return%2520a%2526%2526reHasUnescapedHtml.test(a)%253Fa.replace(reUnescapedHtml,escapeHtmlChar):a}var%2520selected=(\'getSelection\'in%2520window%253Fwindow:document).getSelection().toString();var%2520title=window.document.title;var%2520url=window.location.href;var%2520result=\'\';result+=\'%253Ca%2520href=%2522\'+escape(url)+\'%2522%253E\';if(selected){result+=escape(selected)}else{result+=escape(title)}result+=\'%253C/a%253E\';window.prompt(\'created%2520link\',result)}())')}())">copy javascript</a>


<h2>About browser</h2>

A web site which uses CSP (Content Security Policy) blocks bookmarklet on Firefox.

<h3>Bookmarklet without an external script</h3>

<code>javascript:()(function(){window.alert('foo');})</code>

<ul>
  <li>chrome 46: alert 'foo'</li>
  <li>firefox 42: bookmarklet does not work</li>
  <li>ios 8 safari: alert 'foo'</li>
  <li>android 5.1 chrome: alert 'foo'</li>
  <li>android 5.1 firefox 41: bookmarklet does not work</li>
</ul>

<h3>Bookmarklet with an external script</h3>

<ul>
  <li>chrome 46: bookmarklet does not read an external script because of csp violation</li>
  <li>firefox 42: bookmarklet does not work</li>
</ul>

<a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP">CSP (Content Security Policy) - Web security | MDN</a>

</body>
</html>
